
|å±‚æ¬¡|æ•°æ®å•ä½|
|---|---|
|åº”ç”¨å±‚|messageï¼ˆæ¶ˆæ¯ï¼‰|
|**ä¼ è¾“å±‚**|**segmentï¼ˆTCPï¼‰ / datagramï¼ˆUDPï¼‰**|
|ç½‘ç»œå±‚|packet|
|æ•°æ®é“¾è·¯å±‚|frame|
|ç‰©ç†å±‚|bit|

## TCP(Transmission Control Protocol)

**TCP çš„æœ¬è´¨ï¼šå¯é çš„ã€é¢å‘è¿æ¥çš„ä¼ è¾“åè®®**
 **1ï¸âƒ£ é¢å‘è¿æ¥ï¼ˆconnection-orientedï¼‰**

- é€šä¿¡å‰è¦å…ˆå»ºç«‹è¿æ¥ï¼ˆä¸‰æ¬¡æ¡æ‰‹ï¼‰
    
- é€šä¿¡ç»“æŸè¦é‡Šæ”¾è¿æ¥ï¼ˆå››æ¬¡æŒ¥æ‰‹ï¼‰
      
 **2ï¸âƒ£ ç«¯åˆ°ç«¯çš„å­—èŠ‚æµï¼ˆbyte streamï¼‰**

- TCP ä¸å…³å¿ƒâ€œæ¶ˆæ¯è¾¹ç•Œâ€
    
- åªè´Ÿè´£æŠŠ**ä¸€ä¸²å­—èŠ‚**å¯é åœ°ä»ä¸€ç«¯é€åˆ°å¦ä¸€ç«¯

### TCP Service Model

- **Full-duplex**ï¼šåŒæ–¹å¯ä»¥åŒæ—¶å‘æ•°æ®
- **Point-to-point**ï¼šåªèƒ½ä¸¤ä¸ªç«¯ç‚¹ï¼ˆä¸æ”¯æŒå¹¿æ’­/å¤šæ’­ï¼‰

ğŸ‘‰ ä¸€ä¸ª TCP è¿æ¥ = **ä¸¤ä¸ªè¿›ç¨‹ä¹‹é—´**

### TCP Protocol

## **ä¸€ã€å…ˆè®°ä¸€å¥â€œæ€»çº²â€**

> **TCPï¼šç»™â€œå­—èŠ‚â€ç¼–å·ï¼Œç”¨â€œæ®µâ€æ¥ä¼ ï¼Œç”¨ ACK å‘Šè¯‰å¯¹æ–¹æˆ‘è¿˜æƒ³è¦å“ªä¸ªå­—èŠ‚**

ä¸‹é¢æ‰€æœ‰å›¾ï¼Œéƒ½æ˜¯åœ¨è§£é‡Šè¿™å¥è¯ã€‚

---

## **äºŒã€å­—èŠ‚åºåˆ—å·ç¤ºæ„å›¾ï¼ˆæœ€å…³é”®ï¼‰**


å‡è®¾åº”ç”¨å±‚è¦å‘é€ä¸€ä¸²æ•°æ®ï¼š

```
åº”ç”¨å±‚å­—èŠ‚æµï¼ˆæ— é™é•¿ï¼‰ï¼š

å­—èŠ‚ç¼–å· â†’
1000 1001 1002 1003 ... 1499 1500 1501 ...
|---------------------------------------|
```

ğŸ‘‰ **æ¯ä¸€ä¸ªå­—èŠ‚éƒ½æœ‰ä¸€ä¸ªåºåˆ—å·**

---

## **ä¸‰ã€TCP æŠŠå­—èŠ‚â€œæ‰“åŒ…æˆ segmentâ€**


å‡è®¾ TCP å†³å®šè¿™æ ·åˆ†æ®µï¼š

```
Segment #1
SEQ = 1000
æ•°æ®é•¿åº¦ = 500 å­—èŠ‚

æºå¸¦çš„å­—èŠ‚ï¼š
[1000 .................................. 1499]
```

```
Segment #2
SEQ = 1500
æ•°æ®é•¿åº¦ = 500 å­—èŠ‚

æºå¸¦çš„å­—èŠ‚ï¼š
[1500 .................................. 1999]
```

âš ï¸ é‡ç‚¹ï¼š

- **Sequence Number = æœ¬æ®µç¬¬ä¸€ä¸ªå­—èŠ‚çš„ç¼–å·**
    
- ä¸æ˜¯â€œè¿™æ˜¯ç¬¬å‡ ä¸ª segmentâ€
    

---

## **å››ã€æ¥æ”¶æ–¹å¦‚ä½• ACKï¼Ÿï¼ˆè€ƒè¯•é«˜é¢‘ï¼‰**

æ¥æ”¶æ–¹æˆåŠŸæ”¶åˆ° Segment #1 åï¼š

```
å·²æ”¶åˆ°å­—èŠ‚ï¼š
[1000 .................................. 1499]

æˆ‘æ¥ä¸‹æ¥æƒ³è¦çš„æ˜¯ â†’ 1500
```

äºæ˜¯å›ä¸€ä¸ª ACKï¼š

```
ACK = 1500
```

ğŸ‘‰ å«ä¹‰æ˜¯ï¼š


> **1000 ~ 1499 éƒ½ OKï¼Œè¯·ä» 1500 å¼€å§‹ç»§ç»­å‘**

---

## **äº”ã€æ»‘åŠ¨çª—å£æ•´ä½“ç¤ºæ„å›¾ï¼ˆæ ¸å¿ƒæœºåˆ¶ï¼‰**


å‡è®¾å‘é€çª—å£å¤§å° = 1000 å­—èŠ‚ï¼š

```
å‘é€æ–¹è§†è§’ï¼ˆå­—èŠ‚ç¼–å·è½´ï¼‰ï¼š

|---- å·²å‘é€å¹¶ç¡®è®¤ ----|---- å·²å‘é€æœªç¡®è®¤ ----|---- å¯å‘é€ ----| ä¸å¯å‘é€ |
0                   1000                  2000           3000
                    â†‘                     â†‘
                  ACK=1000           Window å…è®¸çš„ä¸Šé™
```

 **å‘ç”Ÿ ACK åçª—å£â€œæ»‘åŠ¨â€**

æ”¶åˆ°ï¼š

```
ACK = 2000
```

çª—å£å‘å³æ»‘åŠ¨ï¼š

```
|---- å·²ç¡®è®¤ ----|---- å·²ç¡®è®¤ ----|---- å¯å‘é€ ----|
0              1000            2000            30000
```

ğŸ‘‰ è¿™å°±æ˜¯ **sliding window**

---

## **å…­ã€ACK + æ•°æ®â€œæå¸¦â€ï¼ˆpiggybackï¼‰**

  

ä½  PPT é‡Œè¿™å¥ï¼š

  

> May be piggy-backed with data going in the other direction

  

ç¤ºæ„å›¾ï¼š

```
A â†’ B :  SEQ=1000, data
B â†’ A :  SEQ=5000, ACK=1500, data
```

æ„æ€æ˜¯ï¼š

- B ä¸å•ç‹¬å‘ ACK
    
- **åœ¨å›æ•°æ®çš„æ—¶å€™é¡ºä¾¿æŠŠ ACK å¡«ä¸Š**
    
- å‡å°‘æŠ¥æ–‡æ•°é‡ï¼Œæé«˜æ•ˆç‡
    

---

## **ä¸ƒã€TCP segment é•¿åº¦ä¸ºä»€ä¹ˆæœ‰é™ï¼Ÿ**

  

ç»“åˆä½  PPT çš„è¿™éƒ¨åˆ†ï¼š

```
Segment size limitations:
- Must fit inside IP payload (65535 bytes)
- Limited by MTU (e.g., 1500 bytes for Ethernet)
```

ç¤ºæ„ï¼š

```
ä»¥å¤ªç½‘ MTU = 1500

[ Ethernet ]
[   IP    ] 20 bytes
[   TCP   ] 20 bytes
[  DATA   ] â‰ˆ 1460 bytes  â† è¿™å°±æ˜¯ MSS
```

ğŸ‘‰ æ‰€ä»¥ï¼š

- TCP ä¼š **æ‹†åˆ† / åˆå¹¶åº”ç”¨å†™å…¥çš„æ•°æ®**
    
- åº”ç”¨å±‚å†™ 1MB
    
- TCP å®é™…å¯èƒ½å‘æˆå¾ˆå¤šä¸ª segment
    

---

## **å…«ã€æŠŠæ•´é¡µ PPT ç¿»è¯‘æˆâ€œäººè¯ç‰ˆâ€**

  

- > TCP ä¸æŒ‰æŠ¥æ–‡ç¼–å·ï¼Œè€Œæ˜¯ç»™**æ¯ä¸ªå­—èŠ‚ç¼–å·**
    
- > TCP ç”¨ segment æ‰¿è½½å­—èŠ‚
    
- > Sequence Number = æœ¬æ®µç¬¬ä¸€ä¸ªå­—èŠ‚
    
- > ACK = æ¥æ”¶æ–¹â€œä¸‹ä¸€ä¸ªæƒ³è¦çš„å­—èŠ‚â€
    
- > æ»‘åŠ¨çª—å£æ§åˆ¶èƒ½å‘å¤šå°‘ã€ä»€ä¹ˆæ—¶å€™é‡ä¼ 
    
- > segment å¤§å°å— MTU å’Œ IP é™åˆ¶
    
