### ① 架构层（最重要）

他们关心你**有没有“工程脑子”**：

- 为什么要做缓存？
    
- 本地缓存 vs 分布式缓存？
    
- geecache 的整体结构是怎样的？
    
- 各个模块怎么解耦？
    

👉 **这一层，比代码细节重要 3 倍**

---

### ② 关键机制层（核心）

比如 geecache 里典型的几个点：

- LRU 是怎么实现的？
    
- 为什么用一致性哈希？
    
- singleflight 是解决什么问题？
    
- 缓存击穿 / 穿透 / 雪崩怎么考虑？
    
- 并发安全是怎么保证的？
    

👉 **这是面试最爱问的**

---

### ③ 关键代码级（但不是所有代码）

面试官**只会盯几个“关键函数”**，例如：

- `Get()` 的整体流程
    
- LRU 的 `Get / Add`
    
- 一致性哈希的 `Get(key)`
    
- PeerPicker 的设计
    

👉 **不需要记住每一行，但要知道：**

- 调用链
    
- 核心逻辑
    
- 为什么这么写
    

---

### ④ 扩展 & 思考（加分项）

比如：

- 如果数据量变大怎么办？
    
- 如果要加过期时间？
    
- 如果要落盘？
    
- 如果要支持多副本？
    
- 如果 QPS 上来，哪里是瓶颈？
    

👉 **这部分决定你是“会写代码的人”还是“有潜力的工程师”**

#### ✔ LRU

- 用什么结构实现？（map + 双向链表）
    
- 为什么 Get 时要移动节点？
    
- 淘汰策略怎么触发？
    

#### ✔ 一致性哈希

- 为什么不用普通 hash？
    
- 虚拟节点解决了什么问题？
    
- 节点上下线会发生什么？
    

#### ✔ singleflight

- 解决什么问题？
    
- 没它会发生什么？
    
- 用 channel / waitgroup 怎么实现？
    

#### ✔ 并发安全

- 哪些地方要加锁？
    
- 为什么 cache 要加 mutex？
    
- 有没有可能死锁？